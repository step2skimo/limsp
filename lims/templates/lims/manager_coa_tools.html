<!DOCTYPE html>
<html>
<head>
    <title>COA Tools | Manager</title>
    <style>
        body {
            font-family: "Segoe UI", sans-serif;
            margin: 30px;
            background: #f5f7fa;
            color: #333;
        }
        h2 {
            margin-bottom: 25px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }
        th, td {
            padding: 12px 15px;
            border: 1px solid #ddd;
            font-size: 0.95em;
        }
        th {
            background-color: #f0f0f0;
            text-align: left;
            color: #444;
        }
        .btn {
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            text-decoration: none;
            display: inline-block;
            margin: 2px 0;
        }
        .green { background: #27ae60; color: white; }
        .blue { background: #2980b9; color: white; }
        .gray { background: #7f8c8d; color: white; }
        .outline { border: 1px solid #555; color: #555; background: white; }
    </style>
</head>
<body>

<h2>ğŸ“„ COA Tools â€“ Manager View</h2>

<form method="get" style="margin-bottom: 20px;">
    <input type="text" name="q" value="{{ query }}" placeholder="Search client name or organization" />
    <select name="days">
        <option value="">Filter by date</option>
        <option value="7" {% if filter_days == "7" %}selected{% endif %}>Last 7 days</option>
        <option value="30" {% if filter_days == "30" %}selected{% endif %}>Last 30 days</option>
        <option value="90" {% if filter_days == "90" %}selected{% endif %}>Last 90 days</option>
    </select>
    <button type="submit">ğŸ” Filter</button>
    <a href="{% url 'manager_coa_tools' %}">ğŸ”„ Reset</a>
</form>

{% for client in clients %}
    <h3>ğŸ‘¤ {{ client.name }} ({{ client.organization }})</h3>
    <table>
        <thead>
            <tr>
                <th>Sample Code</th>
                <th>Individual COA</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for sample in client.sample_set.all %}
                <tr>
                    <td>{{ sample.sample_code }}</td>
                    <td>
                        <a href="{% url 'generate_coa_pdf' client.id sample.id %}" class="btn green">Download</a>

                    </td>
                    <td>
                        <span class="btn gray" style="cursor: default;">
                            {{ sample.status|default:"Pending" }}
                        </span>
                    </td>
                </tr>
            {% empty %}
                <tr><td colspan="3">No samples found for this client.</td></tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td><strong>Client Tools</strong></td>
                <td colspan="2">
                    <a href="{% url 'generate_combined_coa_pdf' client.client_id %}" class="btn blue">ğŸ“¥ All COAs</a>
                    <a href="{% url 'generate_pivoted_coa_pdf' client.client_id %}" class="btn gray">ğŸ“Š Pivot</a>
                    <a href="{% url 'assign_by_parameter_overview' client.client_id %}" class="btn outline">âš™ï¸ Assign</a>
                    <a href="{% url 'manager_coa_dashboard' client.client_id %}" class="btn outline">ğŸ“¤ Dashboard</a>
                </td>
            </tr>
        </tfoot>
    </table>
{% endfor %}

</body>
</html>
